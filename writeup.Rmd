---
header-includes:
  - \usepackage{titling}
  - \pretitle{\vspace{-1.77cm}\begin{center}\Large}
  - \posttitle{\end{center}}
title: |
  | Somersaulting to Gold:
  | Optimizing USA’s Artistic Gymnastics Team Selection Strategy
author: "Emily Zhao, Elyse McFalls, Young Jun, Evan Kim"
geometry: "left=1.5cm,right=1.5cm,top=1.5cm,bottom=1.4cm"
fontsize: 10.3pt
date: "2023-11-20"
output:
  pdf_document:
    includes:
      in_header: header.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
```

## I. Introduction 
\vspace{-1mm} 
\text{ }\text{ }\text{ }\text{ } Gymnastics has swiftly risen to become one of America's cherished pastimes, with recent polls revealing it to be the most anticipated Olympic event among Americans $^1$ This heightened enthusiasm is largely attributed to the historical success the U.S. has enjoyed in the Olympics, particularly in women's artistic gymnastics. Dominant performances by teams like the Final Five in 2016 and athletes like Simone Biles (active 2011 - current) have brought immense prominence to the sport and its athletes. $^2$ While the U.S. men's rhythmic gymnastics team may not be as dominant, they have consistently secured top-five placements in team events at the Olympics and have bolstered decorated athletes like Khoi Young (active 2018 - current) in recent years. $^3$ We expect that millions of Americans are anticipating the gymnastics events at the 2024 Olympic Games in Paris, France.$^4$ This anticipation is coupled with an expectation of U.S. dominance at the Olympics, mirroring the success we have seen in the past. One may ask then: How can we ensure that the U.S. reigns supreme? The answer lies in assembling formidable teams capable of winning the most medals.\newline
\text{ }\text{ }\text{ }\text{ } Historically, U.S. Olympic team rosters are shaped by the results of the U.S. Olympic Team Trials. The trials will be hosted in June, 2024, for this upcoming cycle $^5$ Here, each invited athlete's performance determines their spot on the team. Athletes are required to complete all apparatuses twice (4 for women, 6 for men), and scores from each event (8 for women, 12 for men) are combined to generate a final score. The selection committee then uses a combination of the competition results and the teams’ needs to decide on the final rosters. In the last Olympic cycle, the top two performers for women and the top performer for men secured automatic spots, while the remaining slots were determined by the selection committee. $^6$ Given this meticulous process, it will be some time before the U.S. Olympic gymnastics teams are unveiled, and even longer before we can assess how they will perform on the big stage. The selection committee also faces the arduous task of determining the optimal team makeup. This season, the challenge is particularly difficult for the women's team given the abundance of strong candidates. $^7$ \newline
\text{ }\text{ }\text{ }\text{ } In this paper, we present a simulation-based way to determine the best U.S. Olympic men and women’s gymnastics teams. Our method utilizes historical data on each athlete’s performances to simulate pseudo-Olympic data to see how well the U.S. will fare under different team makeups.We imagine that our algorithmic approach would be useful supplementary material for the selection committee to consider when finalizing the roster. Moreover, the results of these simulations may also be enjoyed by fans of the sport who are interested in gaining some insight into what to expect from the Olympics given the athletes’ past scores.

**_Background_** \newline
\text{ }\text{ }\text{ }\text{ } Recognizing the effectiveness of modeling for predictions in general, our gymnastics data poses a challenge due to its sparse functional nature. This refers to the presence of few and unevenly distributed measurements for each athlete on each apparatus, making accurate modeling of individual performance challenging. Despite these difficulties, there are various approaches to address this issue. One method involves pairing athletes with sparse longitudinal data with those who have a more extended data history. In this scenario, predictions for the athlete with limited data are informed partially by the experiences of the athlete with more extensive data $^8$. Another strategy is to create a model exclusively based on athletes with abundant and consistent data, which is then applied to athletes of interest with fewer data points$^9$. Additionally, pooling all available data and employing clustering algorithms to identify similar players offers a potential solution to enhance predictions based on shared characteristics among athletes $^10$.\newline
\text{ }\text{ }\text{ }\text{ } The main problem with these approaches for our purposes is that gymnasts do not typically have long careers, even those that make the Olympics. There also does not appear to be a lot of previous literature on predicting gymnasts scores which could help inform this project. Therefore, we opted for the simulation approach which would sample from a distribution of the current athlete’s past scores. Figures 15-24 in the appendix show the top athletes by their best, worst, and average scores for each apparatus to give an idea of the results we expect to see from the simulation. 

\vspace{-1mm} 
## II. Methodology 
**_Data Collection:_**  \newline
\text{ }\text{ }\text{ }\text{ } We were originally provided two data sets from UCSAS: the 2020 Tokyo Olympics women's results and the 2022-2023 season's men and women's results from various competitions. Given the dynamic nature of gymnastics, where athletes' careers are typically short and marked by rapid changes, the period between two Olympic cycles is crucial. It often sees the retirement of established gymnasts and the rise of new talents, significantly altering the sport's competitive hierarchy. (Atikovic et al., 2017)$^{11}$ Therefore, we have elected to only consider the 2022-2023 season's results as relevant data as it more accurately reflects the current competitive landscape and athlete performance trends. In addition, via web scraping and research, we were able to add athletes, both U.S. and non-U.S. based, that were not in the provided dataset but are worth considering in our simulations.\newline
\text{ }\text{ }\text{ }\text{ } Any scores that were missing or recorded as “0” were dropped from the input data for the simulation as we assumed the athlete had chosen not to compete in the event. We also extensively cleaned the data for inconsistencies, mistyped, and changed names for each athlete, while also checking for athletes who switched country allegiances. 

**_Motivation for Kernel Density Estimation (KDE):_**\newline
\text{ }\text{ }\text{ }\text{ } Our refined dataset shows the distribution of scores for each athlete-apparatus combination over the most recent two years. This observation suggests that each combination possesses a unique, true underlying distribution of scores, justifying the use of density estimation. Our method of choice was Kernel Density Estimation (KDE), as opposed to piecewise-histogram density estimation, given the near-continuous nature of gymnastics scores. It offers a significant advantage by centering a smooth kernel function at each data point and aggregating these to form an overall density estimate.While there are over twenty packages in R that assist with density estimation, varying in both theoretical backdrop and computational performance, we employ the 'KernSmooth::bkde()' function, renowned for its speed, accuracy, and robust maintenance. Developed by Wand and Ripley (2010), 'KernSmooth::bkde()' implements the linear binning technique, which distributes data mass between grid points for enhanced accuracy by utilizing "weighted bin counts instead of individual data points".(Deng et al., 2011)$^{12}$

**_Developing the Simulation:_**\newline
\text{ }\text{ }\text{ }\text{ } For the purpose of our analysis, we have fine-tuned the `KernSmooth::bkde()` function to our dataset's specific characteristics. We selected the Gaussian kernel for its efficacy in creating a smooth, continuous approximation of the underlying score distributions, while deliberately forgoing the scale normalization typically associated with canonical kernels to maintain the natural scale of gymnastics scores. $^{13}$ The `bandwidth` is also set as 0.25 all throughout, which yields the optimal empirical balance between over-smoothing and under-smoothing for our aggregated dataset. (See Appendix - Figure 6)\newline
\text{ }\text{ }\text{ }\text{ } Furthermore, for the range of scores we should estimate for each athlete-apparatus combination, we incorporated a `nugget` metric to allow extra variability for athlete-apparatus combinations with fewer than four observations. For example, if the minimum score for an athlete-apparatus combination is initially 4.3, and the nugget adjustment brings it down to 2.3, we re-calibrate the lower limit of the range from 4.3 to 2.3 before proceeding with the kernel density estimation, while ensuring that the lower limit never reaches below 0, a logical baseline for gymnastics scores. This facet provides a buffer that accommodates the potential for higher variability in sparser data. Our methodology is grounded in the principle that past performance can be a predictor of future results, but with a recognition of the stochastic nature of athletic performance. The nugget is calibrated using the standard deviation of all scores for a given apparatus, rewarding consistent high-level performance over time rather than exceptional one-off performances.\newline
\text{ }\text{ }\text{ }\text{ } Incorporating our fine-tuned `KernSmooth` function with our own simulation algorithm, we conducted a total of 1,000 iterations for the following: 4 women’s individual apparatuses — Balance Beam (BB), Floor Exercise (FX), Uneven Bars (UB), Vault (VT) — and 6 men’s individual apparatuses — Horizontal Bar (HB), Floor Exercise (FX), Parallel Bars (PB), Pommel Horse (PH), Still Rings (SR), and Vault (VT). By conducting a total of 1,000 iterations of simulated Olympic events separately for both men and women, we generated a robust collection of datasets  reflecting the potential range of scores for each athlete-apparatus combination, assuming all athletes compete in the events they have historic data for. The aggregation of these results facilitated a comprehensive analysis of the top performers for each apparatus and potential team compositions for both the U.S. and other team-qualifying countries.

**_Weighted Individual Medal Contributions:_** \newline
\text{ }\text{ }\text{ }\text{ } In order to determine the medal potential of each US gymnast, we calculated an average weighted medal score for each event. Mean instead of the median is used in our measure since kernel density estimation smooths data over a range, thereby already accounting for the influence of outliers. We assigned gold a value of 3, silver a value of 2, bronze a value of 1, and anything lower a value of  0. For each simulation, we assigned each competitor a weighted score based on their ranking and then calculated the average weighted score across all simulations. If a gymnast did not have historical data for a specific event, their simulated results would return 0, subsequently removing them from contention for that specific event. When two gymnasts happen to earn the same score within one of the top three spots, they would both be rewarded the same medal score. This average weighted medal score is relative to the performance of other gymnasts and therefore is a better representation of a gymnast’s potential on the team than their score. Then, across simulations of each event, we found each competitor’s average weighted medal score. By conducting this weighted medal calculation for each women’s and men’s event, we can determine the most competitive gymnasts by event and also determine how frequent and valuable their medal contributions are.\newline
\text{ }\text{ }\text{ }\text{ } This calculation averages the gymnast’s range of medal placements in an event to a single value. For instance, if a gymnast scores only one bronze throughout the 1,000 simulations of an event, their average weighted medal score would be 0.001. Meanwhile, a gymnast who consistently earns silver or gold throughout the 1,000 simulations will obtain a weighted average medal score between 2 and 3. This process allows us to identify which individual events Team USA has the highest chance of winning and whether there are particular events that may benefit from a “specialist”, a gymnast who may only excel at one particular event. \newline
\text{ }\text{ }\text{ }\text{ } We used this calculation for all four apparatus for women, all six apparatus for men, and the individual all-around event for both women and men. The individual all-around event weighted score calculation is derived from the same simulation data as the individual events. The individual women’s and men’s all-around scores are calculated by taking the sum of the athlete’s performance in each simulation for all 4 and 6 respective events. Then, the same ranking and medal scoring process for each simulation is applied to the summed all-around scores. \newline 
\text{ }\text{ }\text{ }\text{ }We also calculated the overall median ranking and variance of the athletes for each individual apparatus and all-around event. Rather than using the weighted medal methodology which would have only provided meaningful median scores for a few athletes who consistently excelled and placed in the top 3 across simulations, median rank provides supplementary information to understand the performance of lower-ranked athletes (Figures 13 and 14). We also calculated the variance of ranking across simulations as an indicator of an athlete’s volatility in performance. In hypothetically comparing two athletes with similar median rankings, the athlete with a lower variance could be a more reliable performer and more consistently achieves desired results.

**_Weighted Team Medal Contributions:_**\newline
\text{ }\text{ }\text{ }\text{ } To obtain the weighted team medal contributions, we first filtered for the countries that qualified for a full team. Then, from the individual event simulations, we selected the top three athletes in each apparatus per country to generate a group of top-performing women and men. From this group, we created all possible combinations of 5 athletes from the groups of top performers per country. This left us with all of the possible teams for all of the qualified countries given our criteria. Following the team all-around rules and using the top three scores for each event, we generated all of the scores for each team (source). The team with the highest score for a given country was selected for each simulation and ranked against the other countries’ best teams to determine medal placements for the simulation. Similar to the weighted individual medal contributions, teams that receive gold are assigned a weight of 3, silver placements are assigned a weight of 2, bronze placements are assigned a weight of 1, and anything else is assigned a weight of 0. The average of a team’s placement is their expected medal contribution given that their team was selected as one of the best U.S. teams at least once. Teams that are not selected as the best U.S. team in any simulation will have an expected medal contribution score of 0. The rationale behind this is that we want to prioritize teams that are more consistently the best. A team that has a high score and/or high expected medal count but only reigns as the best U.S. team once or twice is likely to be a fluke given the nature of our simulations. Moreover, teams that do not appear as the best U.S. team in any simulation likely will not be the best U.S. team for the team event.  \newline
\text{ }\text{ }\text{ }\text{ } For men’s, the other qualifying teams include Canada, China, Germany, Great Britain, Italy, Japan, Spain, Switzerland, Netherlands, Turkey, and Ukraine. For women’s, the other qualifying teams include Australia, Brazil, Canada, China, France, Great Britain, Italy, Japan, Netherlands , Romania, and South Korea. $^{15}$ All these teams had at least five athletes qualify under our initial threshold criteria except for the men’s Netherlands team which only had four athletes qualify under our criteria. After further research on the historic performance of the Netherlands men’s team, we believed that they are not in contention for a team all-around medal and therefore removed their team from the team simulations.$^{16}$ 

**_Assumptions:_** \newline
\text{ }\text{ }\text{ }\text{ } We applied a series of assumptions to reduce noise in the data, computational demand, and simplify the selection process. Firstly, we decided to establish a performance cutoff for the competitors inputted into the simulation function. We removed any athlete who has not placed in the top 5 for any competition in the 2022-2023 seasons, as we assumed that their lack of data from the recent seasons or their relatively subpar performance indicated that they likely would not make an Olympic team.  This criteria is supported by the 2020 Team USA artistic gymnastics team selections as all members of the selected teams had placed in the top 5 of a competition from 2019 to 2020. This criteria allows for flexibility as even if a gymnast is a “specialist”, their top 5 strong performance in a singular event will be sufficient for including them in the dataset. However, individual athletes who already qualified for the 2024 Olympics were not bound to this cutoff.$^{15}$  \newline
\text{ }\text{ }\text{ }\text{ } In the selection of our team, we also assume that these gymnasts will be performing at their optimal condition. In our selection process, we have also removed some athletes which have either announced their retirement or have suffered a recent significant injury. One notable gymnast who was removed from the dataset due to this criteria is Suni Lee. At her peak performance, gymnastics fans believe she is a strong contender on both uneven bars and balance beam. $^{17}$ However, in April 2023, she announced that she was withdrawing from collegiate gymnastics and had been diagnosed with an incurable kidney disease. The uncertainties surrounding her disease and its progression over the next year would potentially make her chance of performing well volatile, so we could not confidently place her in our recommendation given her medical unknown condition. For the rest of the athletes, we assume that gymnasts will be able to participate in multiple events throughout the Olympics competition and will also not get hurt or injured from now until the Olympics. \newline
\text{ }\text{ }\text{ }\text{ } In the simulation of results, we grouped all historic vault scores, either from team or the first or second round of individual vaults, all into a common vault category, unifying labels such as “VT1” and “VT2” into simply “VT”. We also applied the assumption that a gymnast’s performance in each round — qualifying, final, all-around qualifying, all-around final, team qualifying, and team final — would all follow a similar kernel density distribution and therefore can be aggregated into one cumulative apparatus category. To test the assumption of similar scores by round, we inputted all data from our constrained dataset to conduct three-way ANOVA tests by athlete, round stage (final or qualifying), round type (all around, individual, or team), and all interactions with score as the response. We used a significance level of 1.25% for women and 0.83% for men to give each test a Type I error rate of 5% with Bonferroni’s correction.$^{18}$ \newline
\text{ }\text{ }\text{ }\text{ } For both men and women, the effect of athlete on score was unsurprisingly a significant effect (p-value: <0.001), controlling for all else. For women, only the balance beam apparatus showed sufficient evidence for a difference in score by round type (team, all around, individual) with a p-value of 0.011, controlling for all else.  For men,  the interaction between athlete and round type was significant for the floor apparatus (p-value: <0.001). This finding supports the notion that the effect of round type on floor scores is contingent on the athlete or vice-versa. Given the overwhelming insignificant outcomes for the round stage and round type main effects along with their interactions at our specified significance levels, we moved forward with aggregating all of the results for each apparatus. The figures show the average score for each apparatus by round for the top scorers to further demonstrate similarities across rounds. (See Appendix - Figures 7 and 8)

## III. Results \newline
**_Individual Events - Top USA Women_** \newline
\text{ }\text{ }\text{ }\text{ } A total of 180 female athletes were each simulated 4,000 times to generate 1,000 performances in each apparatus event. After conducting four simulations reporting for the four events, we generated an aggregated group of seven athletes where all athletes ranked in the Top 3 Americans for any event. In the calculations of success, we used the metric “weighted medal score” to represent their weighted medal contribution to Team USA. As mentioned earlier, bronze represents 1, silver 2, and gold 3. This score does not indicate how many medals each athlete earns but rather the “value” of their medals earned. \newline
\text{ }\text{ }\text{ }\text{ } In the following table, each event column has three yellow-highlighted cells, indicating the athletes with the top 3 medal scores, and one blue-highlighted cell, indicating the fourth highest medal score. Simon Biles emerged from the simulation as having a top 3 medal score in all five events (BB: 1.515, FX: 2.747, UB: 0.064, VT: 1.94, AA: 2.962, Figure 1). Shilese Jones posted top 3 medal scores for UB, VT, and AA and also fourth place scores in BB and FX (BB: 0.034, FX: 0.195, UB: 0.567, VT: 0.260, AA: 0.595, Figure 1). For the rest of the gymnasts, they either placed in the top 3 scores for one or two events. \newline
\text{ }\text{ }\text{ }\text{ } From the total weighted medal scores, assuming each athlete competes in all events, Biles emerges as the clear strongest contributor to the weighted medal scores (9.228). Konnor McClain posts the second highest total weighted medal score (2.016). The gap between Biles and the rest of the women candidates is wide, expectedly as most gymnasts only show weighted medal scores above 0.1 for one or two events. \newline


```{r, echo=FALSE}
womenIndividualResultsSummary <- read.csv("filesForWriteup/individualWomenResultsSummary.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)

highlightCellYellowWomenIndividual <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customyellow}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}

highlightCellBlueWomenIndividual <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customblue}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}



# Apply the function to all cells in the dataframe
highlightYellowWomenIndividual <- c("1.515", "2.747", "0.064", "1.940", "2.962", "0.567", "0.260", "0.595", "0.233", "0.779", "1.246", "0.503", "0.049", "0.401", "0.354")

highlightBlueWomenIndividual <- c("0.034", "0.195", "0.039", "0.180", "0.091")


womenIndividualResultsSummary[, 1:(ncol(womenIndividualResultsSummary) - 1)] <- as.data.frame(lapply(womenIndividualResultsSummary[, 1:(ncol(womenIndividualResultsSummary) - 1)], function(column) {
  sapply(column, highlightCellYellowWomenIndividual, specified_values = highlightYellowWomenIndividual)
}))

womenIndividualResultsSummary[, 1:(ncol(womenIndividualResultsSummary) - 1)] <- as.data.frame(lapply(womenIndividualResultsSummary[, 1:(ncol(womenIndividualResultsSummary) - 1)], function(column) {
  sapply(column, highlightCellBlueWomenIndividual, specified_values = highlightBlueWomenIndividual)
}))

# Generate the table with kable for LaTeX output
kable(womenIndividualResultsSummary, 
      col.names = c("Athlete", 
                    "BB", 
                    "FX", 
                    "UB", 
                    "VT", 
                    "AA", 
                    "Total Weighted Medal Score"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```
_Figure 1: Top 7 US Female Gymnasts’ Simulated Weighted Individual Medal Scores by Event_ \newline
\text{ }\text{ }\text{ }\text{ } Relative to our international competitors, the US has a varying number of gymnasts in the Top 10 weighted medal scores (BB: 3, FX: 6, UB: 2, VT: 6, AA: 6). Broadly, the US team has more strong competitors for FX, VT, and AA while other countries, such as China, Algeria, and Brazil, have stronger competitors in BB and UB. UB is the only event where the US claimed none of the Top 3 weighted medal scores. In terms of determining the strongest individual non-US competitor, Brazil’s Rebeca Andrade obtains one of the Top 3 weighted medal scores in three events - FX, VT, and AA. (See Appendix, Fig. 9)

**_Team Event - Top USA Women_** \newline
\text{ }\text{ }\text{ }\text{ } After 1,000 iterations where the scores of all combinations of top athletes in team-qualifying countries are calculated and the top-scoring team from each country is ranked, we discovered that in every simulation, the top-scoring U.S. generated team always earns gold and therefore earns an average weighted medal score of 3. With that baseline success, we then considered the frequency in which each team was selected as the top-scoring U.S. team in the simulation and their average simulation total team score. From these calculations, we determined the following teams as having the highest average simulation total scores, ordered by number of occurrences. \newline
```{r echo=FALSE, warning=FALSE, message=FALSE}
womenTeamResultsSummary <- read.csv("filesForWriteup/women_top3_USA_teams.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)


kable(womenTeamResultsSummary, 
      col.names = c("", 
                    "Team", 
                    "Avg. Score", 
                    "Occurrences", 
                    "Avg. Weighted Medal Score"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```
_Figure 2: Top 3 Women’s Team Configurations and Average Score ordered by number of times selected as highest ranked US team._ \newline
\text{ }\text{ }\text{ }\text{ } The team — Simone Biles, Konnor McClain, Jade Carey, Shilese Jones, and Zoe Miller — were most consistently selected as the highest-scoring U.S. team across simulations (29), which is an indication of their reliability in performance. The second most consistently selected team was Simone Biles, Sky Blakely, Konnor McClain, Jade Carey, and Shilese Jones, which in fact had a marginally higher average simulation score (173.649) but less occurrences than the former team (27). All three top scoring teams had Simone Biles, Konnor McClain, and Shilese Jones, designating each athlete’s vital contribution to high team scores. All highest-potential team configurations (Figure 2) had an average weighted medal score of 3. \newline
\text{ }\text{ }\text{ }\text{ } By generating every combination of the 7-high scoring women above, we generated our final medal calculations, including the top 2 expected weighted medal scores by individual apparatus and the expected team weighted medal score.. The Top 3 teams with the highest expected total weighted medal scores listed all include Simone Biles, Shilese Jones, Jade Carey, and Konnor McClain. In the top three team combinations, the options for the fifth member are Zoe Miller, Kaliya Lincoln, and Skye Blakely. The first team - Simone Biles, Jade Carey, Shilese Jones, Konnor McClain, Zoe Miller - had the highest expected total weighted medal score (15.938) with Miller boosting the UB total score (0.921). The second team - Simone Biles, Jade Carey, Shilese Jones, Konnor McClain, Kaliya Lincoln - had the second highest total weighted score (15.816) with Lincoln boosting the FX total score (3.148). \newline
```{r echo=FALSE, warning=FALSE, message=FALSE}
womenTeamConfigurations <- read.csv("filesForWriteup/top_3_women_team_configurations.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)


kable(womenTeamConfigurations, 
      col.names = c("Team Combination", 
                    "BB", 
                    "FX", 
                    "UB", 
                    "VT",
                    "AA",
                    "Team",
                    "ETW Medal Score"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE)

```
_Figure 3: Top 3 Women’s Team Configurations from Individual Event Weighted Medal Optimization. (ETW: Expected Total Weighted)_ 

**_Individual Events - Top USA Men_** \newline
\text{ }\text{ }\text{ }\text{ } A total of 194 male athletes were each simulated 6,000 times to generate 1,000 performances in each of the six apparatus events for men. After finding the top 3 US athletes for each apparatus by weighted medal score, we created an aggregated group of 13 athletes. In the table below, each event column has three yellow-highlighted cells, indicating the athletes with the top 3 medal scores, and one blue-highlighted cell, indicating the fourth highest medal score. Brody Malone has a top 3 weighted medal score in four events (HB: 0.669, FX: 0.206, SR: 0.006, AA: 0.456) and one fourth place weighted medal score (PH: 0.035). For the rest of the gymnasts, they either achieved one or two top 3 weighted medal score placements. \newline
\text{ }\text{ }\text{ }\text{ }From the sum of weighted medal scores across events, assuming each athlete competes in all events, Malone (1.468), Khoi Young (0.834), Curran Phillips (0.733), and Stephen Nedoroscik (0.698) have total scores above 0.5. \newline
```{r, echo=FALSE}
menIndividualResultsSummary <- read.csv("filesForWriteup/individualMenResultsSummary.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)

highlightCellYellowMenIndividual <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customyellow}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}

highlightCellBlueMenIndividual <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customblue}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}



# Apply the function to all cells in the dataframe
highlightYellowMenIndividual <- c("0.669", "0.206", "0.006", "0.457", "0.388", "0.329", "0.033", "0.585", "0.042", "0.296", "0.257", "0.264", "0.064", "0.152", "0.698", "0.375", "0.308", "0.194", "0.189", "0.137")

highlightBlueMenIndividual <- c("0.035", "0.135", "0.119", "0.012", "0.169")


menIndividualResultsSummary[, 1:(ncol(menIndividualResultsSummary) - 1)] <- as.data.frame(lapply(menIndividualResultsSummary[, 1:(ncol(menIndividualResultsSummary) - 1)], function(column) {
  sapply(column, highlightCellYellowMenIndividual, specified_values = highlightYellowMenIndividual)
}))

menIndividualResultsSummary[, 1:(ncol(menIndividualResultsSummary) - 1)] <- as.data.frame(lapply(menIndividualResultsSummary[, 1:(ncol(menIndividualResultsSummary) - 1)], function(column) {
  sapply(column, highlightCellBlueMenIndividual, specified_values = highlightBlueMenIndividual)
}))

# Generate the table with kable for LaTeX output
kable(menIndividualResultsSummary, 
      col.names = c("Athlete", 
                    "HB", 
                    "FX", 
                    "PB", 
                    "PH", 
                    "SR", 
                    "VT",
                    "AA",
                    "Total Weighted Medal Score"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```
_Figure 4: Top 13 U.S. Mens’ Simulated Weighted Individual Medal Scores by Event_ \newline
\text{ }\text{ }\text{ }\text{ } Considering the Top 10 men by apparatus and country, it is evident that Japan and China are leaders in this sport with China holding the all Top 3 weighted medal scores in SR and Japan and China holding 6 out of 10 top weighted medal scores in HB. (See Appendix, Figure 10) This result tracks with previous discussion of men’s gymnastics. $^{19}$ On the other hand, the US materializes as a contender for only a few apparatuses. Highest chances of placing are for parallel bars with Curran Phillips (PB: 0.585) and pommel horse with Stephen Nedoroscik (PH: 0.698). Even so, given the low weighted medal scores for US athletes across the events (All U.S. weighted medal scores are <1), our chances of medaling in most events are limited. 

**_Team Event - Top USA Men_** \newline
```{r echo=FALSE, warning=FALSE, message=FALSE}
menTeamResultsSummary <- read.csv("filesForWriteup/men_top3_USA_teams.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)


kable(menTeamResultsSummary, 
      col.names = c("", 
                    "Team", 
                    "Avg. Score", 
                    "Occurrences", 
                    "Avg. Weighted Medal Score"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```
_Figure 5: Top 3 Men’s Team Configurations and Average Score ordered by number of times selected as highest ranked U.S. team followed by the average score when the team was picked as the best._ \newline
\text{ }\text{ }\text{ }\text{ } The same calculations for finding the best women’s team event combination was also used for the men’s team event. Surprisingly, the best U.S. men’s team ranked 3rd in 65.1% of the simulations, followed by second (23.7%), first (6.8%), and fourth (4.4%). If we expect this result to reflect reality, then the 2024 Olympics may be the first time the U.S. men’s gymnastic team wins a major team medal at an international event since 2014. $^{20}$ Moreover, unlike with the women, the best U.S. team for men was more varied. There were 921 unique teams that reigned supreme over the others in their given simulation. The consistently best U.S. team, consisting of Paul Juda, Brody Malone,  Fred Richard, Donnell Whittenburg, and Asher Hong, only came up four times. Clearly, there is more interchangeability when it comes to crafting the best men’s team, making it a harder task. \newline
\text{ }\text{ }\text{ }\text{ } Brody Malone and Fred Richard are chosen for all of the top 3 teams based on our criteria. Considering the individual and all around performances of these two athletes, the results of the team event simulations are quite interesting. While Malone was expected to win the most individual medals, making it no surprise that he is included in the top teams, Richard was one of the least likely gymnasts to take home multiple individual awards. This result may indicate that Richard is more of a generalist as opposed to a specialist, making him more of an asset in the team competition. He also may be a more volatile competitor, performing really well at times and really poorly at others. Other common names include Paul Juda, Yul Moladeur, and Asher Hong. Again, despite not ranking the highest in our individual weighted medal contribution simulations, these athletes also appear to be proficient in more apparatuses compared to their peers. 

**_Reconciling Conflicting Individual Event Team Configurations and Team Event Configurations_**\newline
\text{ }\text{ }\text{ }\text{ } When finding the best men’s teams using the best combination of the individual events and the team event, we generated conflicting results. There was no overlap between the best 3 teams for highest total individual scores across events and the best 3 teams for highest team event scores. In fact, the top 3 combinations for the individual events were never selected as the best U.S. team for the team event in any simulation. This result indicates that while these combinations of players are optimized for winning individual awards, they do not lend well to winning at the team event. (See Appendix, Figure 11) Athlete-wise, the best individual event combinations all included Stephen Nedoroscik, a player who specializes in pommel horse but otherwise is not a contender for any other apparatus.$^{21}$ These combinations also all include Phillip Curran, a player known for his expertise on the parallel bars but, again, is not a huge competitor in any other competition.$^{22}$ This result confirms the previous assumption that these combinations place more emphasis on individual success, particularly on specific apparatuses, as opposed to team success. Brody Malone is the only player consistently chosen for the team event and best individual combinations. This finding is unsurprising given his relatively high average weighted medal score for almost every apparatus.\newline
\text{ }\text{ }\text{ }\text{ } Due to the ambiguous results we got from the best team event combinations and the best individual event combinations, we decided to find the sum of the average weighted individual scores for the best team event combinations. The results show that the best total expected medal score comes from the team with Brody Malone, Fred Richard, Yul Moladuer, Donnell Whittenburg, and Asher Hong. Compared to the best team combination for the individual events -- Brody Malone, Khoi Young, Curran Phillips, Stephen Nedoroscik, and Colt Walker -- this team is less likely to win awards for parallel bar and pommel horse. This team’s largest advantage is its higher likelihood to win the team event over the best individual event combination team.(See Appendix, Figure 12) 

## IV. Discussion
**_Analysis of Women’s optimal team calculations and Corroboration with previous literature:_**\newline
\text{ }\text{ }\text{ }\text{ } Given her already-record breaking career with 6 World all-around titles, 23 gold medals from Worlds, and 7 Olympic medals, Simone Biles is almost guaranteed to be joining the Olympic team. Her simulations recorded the highest average medal contribution in vault, beam, and floor and the third highest average medal contribution in uneven bars. As a successful and experienced all-arounder, her expertise and leadership are not expressed quantitatively but will be invaluable for the team. \newline
\text{ }\text{ }\text{ }\text{ } Shilese Jones also consistently emerged on all top-scoring teams with consistency across events being one of her greatest advantages. As the all-around bronze medalist at World’s (2023) and all-around silver medalist at Nationals (2023), she has also shown excellence particularly in uneven bars. In the US’ relatively sparse field of strong uneven bars competitors (with only her and Miller in the Top 10 rankings), her command of the uneven bars will be a major asset for the team. Commentators speculate that Biles and Jones “look like locks to make the Paris squad”.$^{23}$ \newline
\text{ }\text{ }\text{ }\text{ } In terms of specialists to add to the team, there are multiple strong contenders. For balanced beam, the US gymnasts with similar scores to Biles is Konnor McClain, the former national All-Around Gold medalist (2022). In the simulation, China posted the strongest competitors with young upstarts, Ran Wu and Yaqin Zhou.$^{24,25}$ In floor exercise, five US gymnasts apart from Biles are ranked in the Top 10 in medal scores, with Kaliya Lincoln as the second-highest scorer. Kaliya Lincoln recently demonstrated her prowess with a gold on floor exercise at the Pan-American games (2023). Their biggest competitors are Rebeca Andrade from Brazil, an Olympic veteran. Uneven bars is the only event in which a U.S. athlete does not make the top 3 rankings for medal scores, but Jones and Zoe Miller have shown strong uneven bars performances historically.$^{26,27}$ In the vault event, 6 American gymnasts make the list with Biles and Olympic veteran Jade Carey taking the top 2 spots. Their biggest competitor is Andrade, who was the 2021 and 2023 World champion on the vault. From examining the distribution of medal scores for the top 10 competitors in each event, we could also extrapolate how lopsided the events will be. For instance, In floor and vault, there appear to be clear front runners with Biles likely taking gold in floor and Biles and Andrade competing head-to-head in vault. The competition appears more even in balance beam with the Chinese and Americans posting similar average medal scores. In uneven bars, Algeria’s Kaylia Nemour shows some advantage in scores, but two of China’s gymnasts also showed impressive results. In worlds, China’s Qiu Qiyuan won gold in uneven bars (2023). The selection committee could take into account the landscape and relative dominance of competitor countries to determine which events to “stack” gymnasts in. \newline
\text{ }\text{ }\text{ }\text{ } Thus, if the selection team is maximizing for overall highest weighted medal count, they should definitely ensure that Simone Biles, Jade Carey, Shilese Jones, and Konnor McClain are on the selected team. For the fifth selection, they should determine which score they hope to optimize. If they hope to optimize their uneven bars medals, then Zoe Miller would be the best fifth choice. If they hope to optimize for floor exercise medals, then Kaliya Lincoln is a better fifth option. Both uneven bars and floor exercise have dominant competitors from other countries that will surely be in medal contention, so this choice should also be based on these two athletes’ improvement trajectory in their respective event.

**_Analysis of Men’s optimal team calculations and Corroboration with previous literature:_** \newline
\text{ }\text{ }\text{ }\text{ } Crafting the best men’s team proved to be a more difficult undertaking as there are way more athletes in contention and a wider variety of specialists and generalists. Without a doubt, the best team, given our results, would include Brody Malone. His historic scores show that he does well in almost every apparatus, winning the U.S. all-around title in 2021 and 2022. He also is especially talented on horizontal bar, taking home the 2022 World title. However, our simulations do not take into account his recent leg surgery, which we will discuss the implications of later.$^{28}$ Nevertheless, assuming that his historic scores would be reflective of his 2024 Olympic performance, Malone certainly deserves a roster spot on the U.S. team. \newline
\text{ }\text{ }\text{ }\text{ } The following four spots should be selected to maximize our opportunities to obtain multiple medals from individual apparatus and all-around events. Unfortunately, we simply are not dominant in individual events. The strongest contenders for these events come from Japan, like Daiki Hokimoto in horizontal bars, and China, like Zhang Boheng. Current discourse on the men’s side does not indicate that these stars show any signs of lessening their dominance in the months leading to the 2024 Olympics.$^{29}$ With our low chance of winning an individual award, we then switch to the team event where we actually predict a high probability of placing in the top 3. Not only does this event carry a higher guarantee of a win, but it also has the potential to mark a shift in how the U.S. men’s gymnastic’s team is viewed by onlookers. As noted by an article from the Associated Press, the individual pockets of success experienced by the men’s team has not done much to propel the sport. This lack of attention has had serious consequences for how men’s gymnastics is funded and supported at the collegiate and professional levels.$^{30}$ The U.S. men’s team placing in the team event at the olympics, which again would  be first time since 2014,  may carry more meaning with it than the number of medals we may expect by optimizing for individual performances. Therefore, with all considered, we decided to optimize our team for the team event.\newline
\text{ }\text{ }\text{ }\text{ } By optimizing in this way, the last four spots would go to Fred Richard, Yul Moladuer, Donnell Whittenburg, and Asher Hong. Most of these athletes have showcased their ability to do well in all of the apparatuses. Fred Richard secured the third position in the all-around event during the 2023 Gymnastics World Championships. Meanwhile, Asher Hong claimed the top spot in the all-around event at the 2023 US Gymnastics Championships, and Yul Moladeur achieved first place in the all-around event at the 2023 Pan-American Championships.$^{31,32,33}$ This team also has a good mix of apparatus specialists. When discussing what talents he could add to the U.S. team, Donnell Whittenburg remarked “We need rings and vault, those are my events”.$^{34}$ Asher Wong can be considered a specialist at vault as well, being able to pull off one of the hardest moves there is -- a full twisting double Tsukahara.$^{35}$ Not to mention, Fred Richard is also the current NCAA horizontal and parallel bar champion and Yul Moladeur took home gold for floor in the 2023 Pan-American championships.$^{36,37}$ Moreover, this team carries some experience with the addition of Donnell Whittenburg and Yul Moldauer, who have been competing on the world stage since 2014 and 2017 respectively.$^{38,39}$ This leadership is especially needed given the men’s team’s tendency to underperform on the big stage.$^{40}$ All of these players make a great complement to Malone, and position the U.S. in the best position to make a statement at the 2024 Olympics. 	

**_Limitations:_** \newline
\text{ }\text{ }\text{ }\text{ } In regards to the data,  we found that while information provided by UCSAS contained most major gymnastic events from 2022-2023, one major category of events not represented in the data were NCAA collegiate competitions. Many gymnasts included in our constrained data set — including Zoe Miller, Colt Walker, Jordan Chiles, Blake Sun, and Ian Skirkey — have competed collegiately and therefore did not have their data fully represented. With these fewer data points, the kernel density distributions generated for these athletes may be less accurate. More broadly, limited historical data was an issue for most gymnasts in our dataset, limiting the accuracy of the kernel density estimates. Moreover, notable limitations of our algorithmic approach include the assumptions made. For instance, we assumed that an athlete’s scores are independent of the round stage (final vs. qualifying), the round type (all around, team, or individual apparatus), the scope of the competition, the order of the competition, and how many apparatuses the athlete had competed in prior (i.e., fatigue). (Atikovic et al., 2017)$^{41}$ Specifically, as seen by the results of the ANOVA, the independence assumption for round type and stage does not hold for all apparatuses. The kernel densities are also calculated so that all results throughout 2022-2023 have equal weight in determining the distribution. However, in many situations athletes from either the U.S or other countries may improve as the Olympics draws closer, and our simulation does not consider these improvement trends. In our team event score simulations, we found the best-performing U.S. team for each simulation and then found their respective ranking. However, this removes the information we generated on the other well-performing U.S. teams that may have also had a chance to medal if they replaced the best-performing U.S. team. Thus, our calculations of the team event weighted medal scores do not comprehensively use all data simulated from the events to determine the performance of every U.S. team configuration but only the best-performing team in each simulation. \newline
\text{ }\text{ }\text{ }\text{ } Based on these limitations, our individual apparatus selections, which were the basis of our simulations, may be inconsistent with widespread expectations and current circumstances. For instance, Jordan Chiles, who is a notable gymnast, is missing from our top-performing women’s gymnasts aggregated list from top U.S women’s gymnasts’ simulated Weighted Individual Medal Scores by Event (See Figure 1). Her bronze medal at the Pan-American Games (Oct. 21-25, 2023) was not accounted for in  the data, and she also earned silver in vault and floor in the World Championships (2022). Her inconsistency in the more recent competitions likely increased the variance in her simulated scores and reduced her average medal contribution scores.$^{42}$ On the other side of considerations, we may have incorrectly classified Brody Malone as being capable and healthy for competition as he recently had  a third leg surgery in July, 2023. While he has stated that he intends to return to practice in April 2024, in preparation for the Olympic trials, his condition and level of performance remain  uncertain. However, removing him from the dataset would have made the generated men’s teams significantly more volatile. 

**_Extensions and Further Work:_**\newline
\text{ }\text{ }\text{ }\text{ } There are many ways our work can be extended to provide more robust and realistic simulation results. Firstly, we would extend this work by addressing the limitations mentioned earlier -- namely the effect of recency, competition scope, and fatigue on scores. The first two limitations could be reconciled through weighting the scores by recency and competition scope. This addition would allow us to account for an athlete’s performance trend and place more emphasis on results coming from harder competitions with more concentrated talent, like the Olympics. Fatigue could be accounted for with a parameter that controlled how many events an athlete is expected to compete in. Furthermore, this work could be extended by adding an algorithm that could find the optimal alternate for a given team. This addition would be particularly useful to selection committees as gymnastics is a high-injury sport, and it is not guaranteed that everyone selected for team U.S. will be healthy enough to compete. Finally, with more time, we would like to validate our simulation methodology by using the same algorithms to predict past competitions, such as the 2023 World Gymnastics Championships. This procedure would ideally encourage more confidence in our current results and help improve upon their accuracy.\newline
\text{ }\text{ }\text{ }\text{ } Overall, our results aim to advise the USA Gymnastics selection committee with the complex task of selecting the women’s and men’s teams for the 2024 Paris Olympics. Our recommended teams are algorithmically optimized for the highest medal contributions, given the scaled “importance” of each medal type. After cross-referencing our results with current literature and predictions for the team selections and with further research on the selected athletes, we are confident in their combined talent, strength, artistry, leadership, and grit — all qualities critical to win gold. \newline

\newpage

## Final Submission: Response to Feedback

Upon reflecting on the feedback, we have updated the introduction and methodology sections.

### Introduction

In the revised introduction, we now include a review of previous research and attempts to predict the performance of sports athletes. While these methods are noteworthy, their applicability to predicting gymnasts' performances is limited due to the typically short career spans of gymnasts. 

Additionally, to provide a clearer picture of the athletes' performance based on the data, we have included the visualizations of the top five male and female athletes' performances in the appendix (Figures 15 to 24).

### Methodology

In our methodology section, we employed kernel density estimation to simulate potential outcomes. This approach inherently smooths the data and accounts for outliers. Consequently, we chose to use the average of the simulation outcomes to calculate the weighted medal counts.

The weighted medal counts directly addresses our research question, making it the most suitable measure to maximize the expected number of medals. However, it does have limitations, particularly in representing athletes who are not part of the elite group frequently winning medals in our simulations. For these athletes, our methodology tends to favor those with higher variability in performance. These individuals might have a lower average score but still possess a higher chance of winning medals in some simulations, compared to athletes with less variability. 

To complement our approach, we also calculated the overall median ranking and variance for each athlete in individual apparatus and all-around events (Figures 13 and 14). The median ranking offers additional insights into the performance of lower-ranked athletes. Furthermore, we analyzed the variance in rankings across simulations as an indicator of an athlete's performance consistency. As expected, we observed that the results of the median ranking were consistent for higher-ranked U.S. male and female athletes, but varied for those ranked lower. Given that our research focuses on identifying top performers to increase the expected number of medals, the median rank findings did not significantly influence our final player selections. However, we included these insights in the appendix, recognizing their value in understanding the performance dynamics of lower-ranking athletes.



\newpage
## V. Appendix

**Figure 6.** Below is an example of the KDE density estimation for a specific athlete-apparatus combination based on scores from the 2022-2023 seasons, using our fine-tuned `KernSmooth::bkde()` function. The red dots represent the scores from the data set, and the blue line estimates the underlying distribution, using the Gaussian family as a parameter.\newline


```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=4.8, fig.height=3.6}
## THIS CODE CHUNK IS JUST TO SHOW FIGURE 1
library(tidyverse)
library(data.table)
library(ggplot2)
library(purrr)
library(dplyr)
library(KernSmooth)
## Re-arranged data
data_women_scores_2022_to_2023 <- read.csv("filesForWriteup/active_restricted_women_2023.csv") %>%  
  select(Country, FullName, Apparatus, Score) %>% 
  # first, making c(VT, VT1, VT2) all just VT, since they're all the same apparatus, just named different at different competitions
  mutate(Apparatus = ifelse(Apparatus %in% c("VT1", "VT2"), "VT", Apparatus))  %>%
  filter(!is.na(Score) & Score != 0) #dropping all NAs -- ask the team: should we also drop zeros? -> emily said yeah 11.13.2023 7 21pm
# this is the data that will feed into the algo
data_ready_for_algo <- data_women_scores_2022_to_2023 %>%
  group_by(Country, FullName, Apparatus) %>%
  summarise(Scores = list(Score), .groups = 'drop')
## Global Fixed Integers
minBBScoreIn_data_women_scores_2022_to_2023 <- min(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "BB"], na.rm = TRUE)
maxBBScoreIn_data_women_scores_2022_to_2023 <- max(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "BB"], na.rm = TRUE)
minFXScoreIn_data_women_scores_2022_to_2023 <- min(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "FX"], na.rm = TRUE)
maxFXScoreIn_data_women_scores_2022_to_2023 <- max(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "FX"], na.rm = TRUE)
minUBScoreIn_data_women_scores_2022_to_2023 <- min(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "UB"], na.rm = TRUE)
maxUBScoreIn_data_women_scores_2022_to_2023 <- max(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "UB"], na.rm = TRUE)
minVTScoreIn_data_women_scores_2022_to_2023 <- min(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "VT"], na.rm = TRUE)
maxVTScoreIn_data_women_scores_2022_to_2023 <- max(data_women_scores_2022_to_2023$Score[data_women_scores_2022_to_2023$Apparatus == "VT"], na.rm = TRUE)

## 2D Table of Global Fixed Integers
minAndMaxScores2DTable <- list(
    BB = list(
        min = minBBScoreIn_data_women_scores_2022_to_2023,
        max = maxBBScoreIn_data_women_scores_2022_to_2023
    ),
    FX = list(
        min = minFXScoreIn_data_women_scores_2022_to_2023,
        max = maxFXScoreIn_data_women_scores_2022_to_2023
    ),
    UB = list(
        min = minUBScoreIn_data_women_scores_2022_to_2023,
        max = maxUBScoreIn_data_women_scores_2022_to_2023
    ),
    VT = list(
        min = minVTScoreIn_data_women_scores_2022_to_2023,
        max = maxVTScoreIn_data_women_scores_2022_to_2023
    )
)
## TO BE FED INTO runOlympicsNTimes
allWomenBBParticipants <- data_ready_for_algo %>%
  select(Country, FullName, Apparatus) %>%
  unique() %>% 
  filter(Apparatus == "BB")

allWomenUBParticipants <- data_ready_for_algo %>%
  select(Country, FullName, Apparatus) %>%
  unique() %>% 
  filter(Apparatus == "UB")

allWomenFXParticipants <- data_ready_for_algo %>%
  select(Country, FullName, Apparatus) %>%
  unique() %>% 
  filter(Apparatus == "FX")

allWomenVTParticipants <- data_ready_for_algo %>%
  select(Country, FullName, Apparatus) %>%
  unique() %>% 
  filter(Apparatus == "VT")

allWomenBBParticipants <- allWomenBBParticipants %>%
  mutate(SimulationResults = lapply(seq_along(FullName), function(x) list()))

allWomenUBParticipants <- allWomenUBParticipants %>%
  mutate(SimulationResults = lapply(seq_along(FullName), function(x) list()))

allWomenFXParticipants <- allWomenFXParticipants %>%
  mutate(SimulationResults = lapply(seq_along(FullName), function(x) list()))

allWomenVTParticipants <- allWomenVTParticipants %>%
  mutate(SimulationResults = lapply(seq_along(FullName), function(x) list()))
## SD of BB Scores of all atheletes in the data (that will be the "nugget" when the there are three or fewer scores in an athlete x apparatus combination; the nugget will be used in estimateKernelDensity)
allBBScoresInTheData <- data_women_scores_2022_to_2023[data_women_scores_2022_to_2023$Apparatus == "BB", "Score"]
nuggetBB <- sd(allBBScoresInTheData)
## SD of UB Scores of all atheletes in the data (that will be the "nugget" when the there are three or fewer scores in an athlete x apparatus combination; the nugget will be used in estimateKernelDensity)
allUBScoresInTheData <- data_women_scores_2022_to_2023[data_women_scores_2022_to_2023$Apparatus == "UB", "Score"]
nuggetUB <- sd(allUBScoresInTheData)
## SD of FX Scores of all atheletes in the data (that will be the "nugget" when the there are three or fewer scores in an athlete x apparatus combination; the nugget will be used in estimateKernelDensity)
allFXScoresInTheData <- data_women_scores_2022_to_2023[data_women_scores_2022_to_2023$Apparatus == "FX", "Score"]
nuggetFX <- sd(allFXScoresInTheData)
## SD of VT Scores of all atheletes in the data (that will be the "nugget" when the there are three or fewer scores in an athlete x apparatus combination; the nugget will be used in estimateKernelDensity)
allVTScoresInTheData <- data_women_scores_2022_to_2023[data_women_scores_2022_to_2023$Apparatus == "VT", "Score"]
nuggetVT <- sd(allVTScoresInTheData)

createProperDataframe = function(countryCode, athleteName, apparatusInitials){
  dataframeToReturn <- data_ready_for_algo %>% 
    filter(Country == countryCode, FullName == athleteName, Apparatus == apparatusInitials) %>% 
    select(Scores) %>% 
    unnest(Scores) %>% 
    unlist()
  
  apparatus <- apparatusInitials
  
  return(list(dataframeToReturn, apparatus))
}

estimateKernelDensity <- function(outputOfCreateProperDataframe, bandwidthValue){
  
  apparatusOfInterestHere = outputOfCreateProperDataframe[[2]]
  
  howManyScoresWeHaveForThatAthleteXApparatusCombination = length(outputOfCreateProperDataframe[[1]])
  
  #setting up appropriate "nugget"
  if (apparatusOfInterestHere == "BB"){
    if (howManyScoresWeHaveForThatAthleteXApparatusCombination < 4){
      nugget = nuggetBB*4
    }
    else{
      nugget = nuggetBB*2
    }
  }
  else if (apparatusOfInterestHere == "UB"){
    if (howManyScoresWeHaveForThatAthleteXApparatusCombination < 4){
      nugget = nuggetUB*4
    }
    else{
      nugget = nuggetUB*2
    }
  }
  else if (apparatusOfInterestHere == "FX"){
    if (howManyScoresWeHaveForThatAthleteXApparatusCombination < 4){
      nugget = nuggetFX*4
    }
    else{
      nugget = nuggetFX*2
    }
  }
  else{
    if (howManyScoresWeHaveForThatAthleteXApparatusCombination < 4){
      nugget = nuggetVT*4
    }
    else{
      nugget = nuggetVT*2
    }
  }
  

  
  kernelLowerLimit = max(minAndMaxScores2DTable$apparatusOfInterestHere$min - nugget, 0)
  kernelUpperLimit = min(minAndMaxScores2DTable$apparatusOfInterestHere$max + nugget, 15.7)
  
  
  almostToReturn <- bkde(x = outputOfCreateProperDataframe[[1]], kernel = "normal", canonical = FALSE, bandwidth = bandwidthValue, gridsize = 401L, range.x = c(kernelLowerLimit, kernelUpperLimit), truncate = TRUE)
  #range.x = c(kernelLowerLimit, kernelUpperLimit)
  dataframeToReturn <- data.frame(
    x = almostToReturn$x, 
    y = almostToReturn$y
  )
  
  return(dataframeToReturn)
}

sampleDataFrame = createProperDataframe(countryCode = "AUS", athleteName = "BROWN GEORGIA", apparatusInitials = "UB")
scoresDataFrame <- data.frame(scores = sampleDataFrame[[1]])

ggplot() +
  geom_line(data = estimateKernelDensity(sampleDataFrame, 0.25), aes(x, y), color = "blue") +
  geom_point(data = scoresDataFrame, aes(x = scores, y = 0), color = "red") +
  ggtitle("KDE of Georgia Brown's Uneven Bars Scores") +
  xlim(11.5, 14.5) +
  xlab("UB Score") +
  ylab("Density") +
  theme(plot.title = element_text(size = 13))



```

\vspace{20mm} 

**Figure 7. ** Below is a table summary of the p-values for Three-way ANOVA for women, where each row represents a particular apparatus. "Round", as written in the table below, is short for Round Stage (final vs. qual); "Type" is short for Round Type (team, all-around, individual); The symbol 'x' indicates an interaction term. As expected, every test showed a significant relationship between athlete and score, controlling all else, indicating that at least one athlete has a different score than all the others for each apparatus. (*Significance level of 0.0125 was set to give a Type I error rate of 5% with Bonferroni's correction)
```{r echo=FALSE, message=FALSE, warning=FALSE}
# THIS IS FOR FIGURE 2 = women ANOVA
women <- read.csv("filesForWriteup/active_restricted_women_2023.csv")

# adding round stage and type
women <- women %>%
  mutate(Round = tolower(Round),
         RoundStage = case_when(stringr::str_like(Round,'%final%') ~ "final",
                           stringr::str_like(Round,'%qual%') ~ "qual"),
         RoundType = case_when(stringr::str_like(Round,'%team%') ~ "team",
                           stringr::str_like(Round,'%aa%') ~ "all around",
                           .default = "individual"))


bb_women <- women %>%
  filter(stringr::str_like(Apparatus,'BB%'))
summary_bb_women <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = bb_women))
#summary_bb_women

ub_women <- women %>%
  filter(stringr::str_like(Apparatus,'UB%'))
summary_ub_women <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = ub_women))
#summary_ub_women

fx_women <- women %>%
  filter(stringr::str_like(Apparatus,'FX%'))
summary_fx_women <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = fx_women))
#summary_fx_women

vt_women <- women %>%
  filter(stringr::str_like(Apparatus,'VT%'))
summary_vt_women <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = vt_women))
#summary_vt_women



library(knitr)
library(dplyr)
library(purrr)

women_anova_summary <- data.frame(
  Apparatus = c("Balance Beam", "Uneven Bars", "Floor Exercises", "Vault"),
  Athlete = c(summary_bb_women[[1]][["Pr(>F)"]][1],summary_ub_women[[1]][["Pr(>F)"]][1],summary_fx_women[[1]][["Pr(>F)"]][1],summary_vt_women[[1]][["Pr(>F)"]][1]),
  `Round Stage (final vs. qual)` = c(summary_bb_women[[1]][["Pr(>F)"]][2],summary_ub_women[[1]][["Pr(>F)"]][2],summary_fx_women[[1]][["Pr(>F)"]][2],summary_vt_women[[1]][["Pr(>F)"]][2]),
  `Round Type (team, all around, individual)` = c(summary_bb_women[[1]][["Pr(>F)"]][3],summary_ub_women[[1]][["Pr(>F)"]][3],summary_fx_women[[1]][["Pr(>F)"]][3],summary_vt_women[[1]][["Pr(>F)"]][3]),
  `Athlete and Round Stage Interaction` = c(summary_bb_women[[1]][["Pr(>F)"]][5],summary_ub_women[[1]][["Pr(>F)"]][5],summary_fx_women[[1]][["Pr(>F)"]][5],summary_vt_women[[1]][["Pr(>F)"]][5]),
  `Athlete and Round Type Interaction` = c(summary_bb_women[[1]][["Pr(>F)"]][4],summary_ub_women[[1]][["Pr(>F)"]][4],summary_fx_women[[1]][["Pr(>F)"]][4],summary_vt_women[[1]][["Pr(>F)"]][4]),
  `Round Stage and Round Type Interaction` = c(summary_bb_women[[1]][["Pr(>F)"]][6],summary_ub_women[[1]][["Pr(>F)"]][6],summary_fx_women[[1]][["Pr(>F)"]][6],summary_vt_women[[1]][["Pr(>F)"]][6])
)



format_p_values <- function(p_value) {
  # Round to the third decimal
  rounded_p <- round(p_value, 3)
  
  # Format to always show three decimal places
  formatted_p <- sprintf("%.3f", rounded_p)
  
  # Apply conditions
  if (rounded_p < 0.001) {
    return("<0.001*")
  } else if (rounded_p >= 0.001 & rounded_p < 0.0125) {
    return(paste0(formatted_p, "*"))
  } else {
    return(formatted_p)
  }
}



women_anova_summary <- women_anova_summary %>%
  mutate(across(-Apparatus, ~map_chr(.x, format_p_values)))



kable(women_anova_summary, 
      col.names = c("Apparatus", 
                    "Athlete", 
                    "Stage", 
                    "Type", 
                    "Athlete x Stage", 
                    "Athlete x Type", 
                    "Stage x Type"))


# "Round Stage means (final vs. qual), Round Type means (team, all around, individual), and "x" indicates interaction term



```

\newpage
**Figure 8. ** Below is a table summary of the p-values for Three-way ANOVA for men, where each row represents a particular apparatus. "Round", as written in the table below, is short for Round Stage (final vs. qual); "Type" is short for Round Type (team, all-around, individual); The symbol 'x' indicates an interaction term. As expected, every test showed a significant relationship between athlete and score, controlling all else, indicating that at least one athlete has a different score than all the others for each apparatus. (*Significance level of 0.0083 was set to give a Type I error rate of 5% with Bonferroni's correction)
```{r echo=FALSE, message=FALSE, warning=FALSE}
# THIS IS FOR FIGURE 3 = men ANOVA
men <- read.csv("filesForWriteup/active_restricted_men_2023.csv")

# adding round stage and type
men <- men %>%
  mutate(Round = tolower(Round),
         RoundStage = case_when(stringr::str_like(Round,'%final%') ~ "final",
                           stringr::str_like(Round,'%qual%') ~ "qual"),
         RoundType = case_when(stringr::str_like(Round,'%team%') ~ "team",
                           stringr::str_like(Round,'%aa%') ~ "all around",
                           .default = "individual"))


ph_men <- men %>%
  filter(stringr::str_like(Apparatus,'PH%'))
summary_ph_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = ph_men))
#summary_ph_men

pb_men <- men %>%
  filter(stringr::str_like(Apparatus,'PB%'))
summary_pb_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = pb_men))
#summary_pb_men

hb_men <- men %>%
  filter(stringr::str_like(Apparatus,'HB%'))
summary_hb_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = hb_men))
#summary_hb_men
  
sr_men <- men %>%
  filter(stringr::str_like(Apparatus,'SR%'))
summary_sr_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = sr_men))
#summary_sr_men

fx_men <- men %>%
  filter(stringr::str_like(Apparatus,'FX%'))
summary_fx_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = fx_men))
#summary_fx_men

vt_men <- men %>%
  filter(stringr::str_like(Apparatus,'VT%'))
summary_vt_men <- summary(aov(Score ~ FullName + RoundStage + RoundType + FullName*RoundType + FullName*RoundStage + RoundStage*RoundType, data = vt_men))
#summary_vt_men


library(knitr)
library(dplyr)
library(purrr)

men_anova_summary <- data.frame(
  Apparatus = c("Horizontal Bar", "Parallel Bars", "Floor", "Still Rings", "Pommel Horse", "Vault"),
  Athlete = c(summary_hb_men[[1]][["Pr(>F)"]][1],summary_pb_men[[1]][["Pr(>F)"]][1],summary_fx_men[[1]][["Pr(>F)"]][1],summary_sr_men[[1]][["Pr(>F)"]][1],summary_ph_men[[1]][["Pr(>F)"]][1], summary_vt_men[[1]][["Pr(>F)"]][1]),
  
  `Round Stage (final vs. qual)` = c(summary_hb_men[[1]][["Pr(>F)"]][2],summary_pb_men[[1]][["Pr(>F)"]][2],summary_fx_men[[1]][["Pr(>F)"]][2],summary_sr_men[[1]][["Pr(>F)"]][2],summary_ph_men[[1]][["Pr(>F)"]][2], summary_vt_men[[1]][["Pr(>F)"]][2]),
  `Round Type (team, all around, individual)` = c(summary_hb_men[[1]][["Pr(>F)"]][3],summary_pb_men[[1]][["Pr(>F)"]][3],summary_fx_men[[1]][["Pr(>F)"]][3],summary_sr_men[[1]][["Pr(>F)"]][3],summary_ph_men[[1]][["Pr(>F)"]][3], summary_vt_men[[1]][["Pr(>F)"]][3]),
  `Athlete and Round Stage Interaction` = c(summary_hb_men[[1]][["Pr(>F)"]][5],summary_pb_men[[1]][["Pr(>F)"]][5],summary_fx_men[[1]][["Pr(>F)"]][5],summary_sr_men[[1]][["Pr(>F)"]][5],summary_ph_men[[1]][["Pr(>F)"]][5], summary_vt_men[[1]][["Pr(>F)"]][5]),
  `Athlete and Round Type Interaction` = c(summary_hb_men[[1]][["Pr(>F)"]][4],summary_pb_men[[1]][["Pr(>F)"]][4],summary_fx_men[[1]][["Pr(>F)"]][4],summary_sr_men[[1]][["Pr(>F)"]][4],summary_ph_men[[1]][["Pr(>F)"]][4], summary_vt_men[[1]][["Pr(>F)"]][4]),
  `Round Stage and Round Type Interaction` = c(summary_hb_men[[1]][["Pr(>F)"]][6],summary_pb_men[[1]][["Pr(>F)"]][6],summary_fx_men[[1]][["Pr(>F)"]][6],summary_sr_men[[1]][["Pr(>F)"]][6],summary_ph_men[[1]][["Pr(>F)"]][6], summary_vt_men[[1]][["Pr(>F)"]][6])
)



format_p_values <- function(p_value) {
  # Round to the third decimal
  rounded_p <- round(p_value, 3)
  
  # Format to always show three decimal places
  formatted_p <- sprintf("%.3f", rounded_p)
  
  # Apply conditions
  if (rounded_p < 0.001) {
    return("<0.001*")
  } else if (rounded_p >= 0.001 & rounded_p < 0.0083) {
    return(paste0(formatted_p, "*"))
  } else {
    return(formatted_p)
  }
}





men_anova_summary <- men_anova_summary %>%
  mutate(across(-Apparatus, ~map_chr(.x, format_p_values)))




kable(men_anova_summary, 
      col.names = c("Apparatus", 
                    "Athlete", 
                    "Stage", 
                    "Type", 
                    "Athlete x Stage", 
                    "Athlete x Type", 
                    "Stage x Type"))


# "Round Stage means (final vs. qual), Round Type means (team, all around, individual), and "x" indicates interaction term



```

\newpage
**Figure 9. ** Top 10 Simulated Weighted Medal Scores for Each Apparatus by Country\newline
```{r echo=FALSE, fig.width = 8, fig.height = 10}


transform_values <- function(column) {
  ranks <- min_rank(-column)  
  result <- ifelse(ranks == 1, 3, ifelse(ranks == 2, 2, ifelse(ranks == 3, 1, 0)))
  return(result)
}

separate_columns <- function(data) {
  
  
  # Bind the result matrix with the original data frame, excluding the original list column
  result_data <- mutate_at(data, vars(starts_with("SimulationResults")), transform_values)

  result_data$avg_result <- rowMeans(select(result_data, starts_with("SimulationResults")))

  return(result_data)
}

aBB_column_data <- read.csv("EZ Simulation Exports/aBB_column_data.csv")
aFX_column_data <- read.csv("EZ Simulation Exports/aFX_column_data.csv")
aUB_column_data <- read.csv("EZ Simulation Exports/aUB_column_data.csv")
aVT_column_data <- read.csv("EZ Simulation Exports/aVT_column_data.csv")


## RUN ONLY ONCE TO SWITCH THE ORDER OF THE NAMES
aBB_column_data$FullName <- sapply(strsplit(aBB_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))
aFX_column_data$FullName <- sapply(strsplit(aFX_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))
aUB_column_data$FullName <- sapply(strsplit(aUB_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))
aVT_column_data$FullName <- sapply(strsplit(aVT_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))



# find the top 10 athletes for each event

aBB_top10 <- separate_columns(aBB_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)


aFX_top10 <- separate_columns(aFX_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

aUB_top10 <- separate_columns(aUB_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
    arrange(desc(avg_result)) %>% 
  slice(1:10)

aVT_top10 <- separate_columns(aVT_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
    arrange(desc(avg_result)) %>% 
  slice(1:10)


aAA_top10 <- read.csv("EZ Simulation Exports/Women_All_Around_Top.csv") %>% 
  slice(1:10)



aBB_top10 <- aBB_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(aBB_top10))) 

aBB_top10_chart <-ggplot(aBB_top10, aes(y= reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y=element_blank()) + 
  geom_col() +
#  scale_x_continuous(limits=c(0, 3), breaks = c(0, 1, 2, 3), labels = c("", "Bronze", "Silver", "Gold")) + 
  scale_x_continuous(limits=c(0, 3)) +
  labs(title = "Balance Beam", x = "Average Medal Score", y = "", fill = "Top 3 Average Scores") +
  facet_grid(factor(Country, unique(Country))~., scales = "free", space='free')+
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))


aFX_top10 <- aFX_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(aFX_top10))) 

aFX_top10_chart <-ggplot(aFX_top10, aes(y= reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y=element_blank()) + 
  geom_col() +
  scale_x_continuous(limits=c(0, 3)) +
  labs(title = "Floor Exercise", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country))~., scales = "free", space='free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))


aUB_top10 <- aUB_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(aUB_top10)))

aUB_top10_chart <- ggplot(aUB_top10, aes(y= reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y=element_blank()) + 
  geom_col() +
  scale_x_continuous(limits=c(0, 3)) +
  labs(title = "Uneven Bars", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country))~., scales = "free", space='free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))


aVT_top10 <- aVT_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(aVT_top10)))

aVT_top10_chart <- ggplot(aVT_top10, aes(y= reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y=element_blank()) + 
  geom_col() +
  scale_x_continuous(limits=c(0, 3)) +
  labs(title = "Vault", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country))~., scales = "free", space='free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

aAA_top10 <- aAA_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(aAA_top10)))


aAA_top10_chart <- ggplot(aAA_top10, aes(y= reorder(FullName, avg_result_allAround), x = avg_result_allAround, fill = top_3)) +
  theme(axis.title.y=element_blank()) + 
  geom_col() +
  scale_x_continuous(limits=c(0, 3)) +
  labs(title = "All-Around", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country))~., scales = "free", space='free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))




library(ggplot2)
library(patchwork)
combined <- aBB_top10_chart + aFX_top10_chart + aUB_top10_chart + aVT_top10_chart + aAA_top10_chart & theme(legend.position = "bottom")

FINAL_VIS_WOMEN <- combined + plot_layout(guides = "collect") + plot_annotation('Top 10 Simulated Weighted Medal Scores by Apparatus',theme=theme(plot.title=element_text(hjust=0.5))) + plot_layout(ncol = 2)

print(FINAL_VIS_WOMEN)
```


\newpage
**Figure 10. ** Top 10 Men by Apparatus and Country (on next page)\newline
```{r echo=FALSE, fig.width = 7.2, fig.height = 10.8}
transform_values <- function(column) {
  ranks <- min_rank(-column)  
  result <- ifelse(ranks == 1, 3, ifelse(ranks == 2, 2, ifelse(ranks == 3, 1, 0)))
  return(result)
}

separate_columns <- function(data) {
  
  
  # Bind the result matrix with the original data frame, excluding the original list column
  result_data <- mutate_at(data, vars(starts_with("SimulationResults")), transform_values)

  result_data$avg_result <- rowMeans(select(result_data, starts_with("SimulationResults")))

  return(result_data)
}



# For mHB
mHB_column_data <- read.csv("EZ Simulation Exports/mHB_column_data.csv")
mHB_column_data$FullName <- sapply(strsplit(mHB_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mFX
mFX_column_data <- read.csv("EZ Simulation Exports/mFX_column_data.csv")
mFX_column_data$FullName <- sapply(strsplit(mFX_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mPB
mPB_column_data <- read.csv("EZ Simulation Exports/mPB_column_data.csv")
mPB_column_data$FullName <- sapply(strsplit(mPB_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mPH
mPH_column_data <- read.csv("EZ Simulation Exports/mPH_column_data.csv")
mPH_column_data$FullName <- sapply(strsplit(mPH_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mSR
mSR_column_data <- read.csv("EZ Simulation Exports/mSR_column_data.csv")
mSR_column_data$FullName <- sapply(strsplit(mSR_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mVT
mVT_column_data <- read.csv("EZ Simulation Exports/mVT_column_data.csv")
mVT_column_data$FullName <- sapply(strsplit(mVT_column_data$FullName, " "), function(x) paste(rev(x), collapse = " "))

# For mHB
mHB_top10 <- separate_columns(mHB_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mHB_top10 <- mHB_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mHB_top10)))

# For mFX
mFX_top10 <- separate_columns(mFX_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mFX_top10 <- mFX_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mFX_top10)))

# For mPB
mPB_top10 <- separate_columns(mPB_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mPB_top10 <- mPB_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mPB_top10)))

# For mPH
mPH_top10 <- separate_columns(mPH_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mPH_top10 <- mPH_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mPH_top10)))

# For mSR
mSR_top10 <- separate_columns(mSR_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mSR_top10 <- mSR_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mSR_top10)))

# For mVT
mVT_top10 <- separate_columns(mVT_column_data) %>% 
  select(FullName, Apparatus, Country, avg_result) %>% 
  arrange(desc(avg_result)) %>% 
  slice(1:10)

mVT_top10 <- mVT_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mVT_top10)))

mAA_top10 <- read.csv("EZ Simulation Exports/Men_All_Around_Top.csv") %>% 
  slice(1:10)
mAA_top10 <- mAA_top10 %>% 
  mutate(top_3 = rep(c("Top 3", "Top 3", "Top 3", rep(NA, 7)), length.out = nrow(mAA_top10)))



# Assuming mHB_top10 is the data frame for Men's Horizontal Bar apparatus
mHB_top10_chart <- ggplot(mHB_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Horizontal Bar", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mFX_top10_chart <- ggplot(mFX_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Floor Exercise", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mPB_top10_chart <- ggplot(mPB_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Parallel Bars", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mPH_top10_chart <- ggplot(mPH_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Pommel Horse", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mSR_top10_chart <- ggplot(mSR_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Still Rings", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mVT_top10_chart <- ggplot(mVT_top10, aes(y = reorder(FullName, avg_result), x = avg_result, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "Vault", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))

mAA_top10_chart <- ggplot(mAA_top10, aes(y = reorder(FullName, avg_result_allAround), x = avg_result_allAround, fill = top_3)) +
  theme(axis.title.y = element_blank()) + 
  geom_col() +
  scale_x_continuous(limits = c(0, 3)) +
  labs(title = "All-Around", x = "Average Medal Score") +
  facet_grid(factor(Country, unique(Country)) ~ ., scales = "free", space = 'free') +
  scale_fill_discrete(name = "Ranking", labels = c("Top 3", "Top 4-10th"))


combined <- mHB_top10_chart + mFX_top10_chart + mPB_top10_chart + mPH_top10_chart + mSR_top10_chart + mVT_top10_chart + mAA_top10_chart & theme(legend.position = "bottom")

combined + plot_layout(guides = "collect") + plot_annotation('Top 10 Men by Apparatus and Country',theme=theme(plot.title=element_text(hjust=0.5))) + plot_layout(ncol = 2)

```



\newpage
**Figure 11. ** Top 3 Men’s Team Configurations from Individual Event Weighted Medal Score Optimization. In the Team event simulation, these teams never emerged as the filtered best US team. (TEMS: Total Expected Medal Score)\newline
```{r echo=FALSE}
appendixFigure11 <- read.csv("filesForWriteup/appendixFigure11.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)


kable(appendixFigure11, 
      col.names = c("Team Combination", 
                    "HB", 
                    "FX", 
                    "PB", 
                    "PH",
                    "SR",
                    "VT",
                    "AA",
                    "Team",
                    "TEMS"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)
```

\vspace{20mm} 


**Figure 12. ** Top 3 Men’s Team Configurations from Team Event Weighted Medal Score Optimization. (TEMS: Total Expected Medal Score)\newline
```{r echo=FALSE}
appendixFigure12 <- read.csv("filesForWriteup/appendixFigure12.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)


kable(appendixFigure12, 
      col.names = c("Team Combination", 
                    "HB", 
                    "FX", 
                    "PB", 
                    "PH",
                    "SR",
                    "VT",
                    "AA",
                    "Team",
                    "TEMS"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)
```

\vspace{20mm} 

**Median Expected Rank and Variance **


**Figure 13. ** Median Rank and Variance of Top Male Gymnasts for each individual event\newline
```{r echo=FALSE}
appendixFigure13 <- read.csv("filesForWriteup/appendixFigure13.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)

highlightCellYellowMenIndividual13 <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customyellow}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}

highlightCellBlueMenIndividual13 <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customblue}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}



# Apply the function to all cells in the dataframe
highlightYellowMenIndividual13 <- c("5 (27.03)",	"45 (51.34)", "39 (25.19)", "7 (8.86)", "17 (13.94)", "19 (24.42)", "49 (39.11)", "13 (38.93)", "23 (21.06)", "34 (37.53)", "11 (12.05)", "16 (22.03)", "14 (8.96)", "25 (39.68)", "8 (25.32)", "13 (33.92)", "14 (59.21)", "17 (47.28)", "20 (50.58)", "15 (17.30)")

highlightBlueMenIndividual13 <- c("33 (33.21)", "50 (49.81)", "40.5 (42.91)", "23 (20.67)", "25 (31.50)")


appendixFigure13[, 1:(ncol(appendixFigure13))] <- as.data.frame(lapply(appendixFigure13[, 1:(ncol(appendixFigure13))], function(column) {
  sapply(column, highlightCellYellowMenIndividual13, specified_values = highlightYellowMenIndividual13)
}))

appendixFigure13[, 1:(ncol(appendixFigure13))] <- as.data.frame(lapply(appendixFigure13[, 1:(ncol(appendixFigure13))], function(column) {
  sapply(column, highlightCellBlueMenIndividual13, specified_values = highlightBlueMenIndividual13)
}))

# Generate the table with kable for LaTeX output
kable(appendixFigure13, 
      col.names = c("Athlete", 
                    "HB", 
                    "FX", 
                    "PB", 
                    "PH", 
                    "SR", 
                    "VT",
                    "AA"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```


\vspace{20mm} 

**Figure 14. ** Median Rank and Variance of Top Female Gymnasts for each individual event\newline
```{r echo=FALSE}
appendixFigure14 <- read.csv("filesForWriteup/appendixFigure14.csv", fileEncoding = "ISO-8859-1")

library(tidyverse)
library(data.table)
library(knitr)
library(dplyr)
library(purrr)

highlightCellYellowMenIndividual14 <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customyellow}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}

highlightCellBlueMenIndividual14 <- function(value, specified_values) {
  if (as.character(value) %in% specified_values) { # Ensure comparison is character to character
    return(sprintf("\\cellcolor{customblue}{%s}", value)) # LaTeX command to color the cell
  } else {
    return(value)
  }
}



# Apply the function to all cells in the dataframe
highlightYellowMenIndividual14 <- c("2 (2.51)", "1 (0.85)", "14 (9.32)", "2 (2.98)", "1 (0.20)", "6 (18.71)", "9 (8.94)", "4 (6.10)", "9 (17.26)", "4 (8.86)", "3 (4.10)", "4 (4.30)", "26 (31.50)", "6 (9.08)", "11 (51.37)")

highlightBlueMenIndividual14 <- c("32 (36.51)", "11.5 (23.89)", "9 (8.34)", "22 (31.09)", "11 (11.18)")


appendixFigure14[, 1:(ncol(appendixFigure14))] <- as.data.frame(lapply(appendixFigure14[, 1:(ncol(appendixFigure14))], function(column) {
  sapply(column, highlightCellYellowMenIndividual14, specified_values = highlightYellowMenIndividual14)
}))

appendixFigure14[, 1:(ncol(appendixFigure14))] <- as.data.frame(lapply(appendixFigure14[, 1:(ncol(appendixFigure14))], function(column) {
  sapply(column, highlightCellBlueMenIndividual14, specified_values = highlightBlueMenIndividual14)
}))

# Generate the table with kable for LaTeX output
kable(appendixFigure14, 
      col.names = c("Athlete", 
                    "BB", 
                    "FX", 
                    "UB", 
                    "VT", 
                    "AA"),
      format = "latex",
      escape = FALSE,
      booktabs = TRUE,
      row.names = FALSE)

```

\vspace{20mm} 


In our research to determine the team with the highest medal count, the weighted medal methodology emerged as the most suitable measure. This approach, however, has its limitations, particularly in understanding the performance of athletes outside the elite group frequently winning medals in simulations. Hence, we have also calculated the median rank as supplementary information to understand the performance of lower-ranked athletes (Figures 13 and 14).

The results show that for female players, the weighted medals and the median ranks yield consistent findings. In the case of US athletes, such as Simone Biles, there is consistent achievement of top scores and ranks, resulting in consistent results across the two measures.

For male players, the top two with the highest expected performance are consistent across weighted medal counts and median rank. However, discrepancies appear in the third and fourth positions. The list of expected top third or fourth players changes across events such as Floor Exercise, Parallel Bars, Pommel Horse, Still Rings, and Vault. This is attributed to the fact that most US male athletes are not part of the elite group that frequently wins medals in the simulation. For these players, the weighted medal methodology favors players with higher variance, who are more likely to win a medal in a few simulations, resulting in a higher weighted medal count. A notable case is the Floor Exercise, where the third and fourth expected ranks shifted to Frederick Richard and Asher Hong, who are among our final choice of athletes. As mentioned, such changes are due to the low variance in the expected performance of these two players. To conclude, our choice of men’s players is based on the top team performance due to the low likelihood of winning medals in individual events. Hence, although there are discrepancies in the two measures, the differences are minimal and do not affect our final choice of athletes.


**Figures 15-18: Women’s Worst, Average, and Best Scores by Apparatus** 

```{r echo=FALSE, warning=FALSE, message=FALSE}

library(tidyverse)
library(ggpubr)
women <- read.csv('cleaned data/restricted_women_2023.csv')
men <- read.csv('cleaned data/restricted_men_2023.csv')
all <- read.csv('cleaned data/full_data_2023.csv')
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
# best average scores
women_vt <- women%>%
  filter(stringr::str_like(Apparatus,'VT%') & Rank <= 5)

women_vt_summary <- women_vt %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

vt_avg <- women_vt_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

vt_best <- women_vt_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

vt_worst <- women_vt_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

```


```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
vt_eda <- ggpubr::ggarrange(vt_worst, vt_avg, vt_best, ncol = 3, common.legend = T)
vt_eda <- ggpubr::annotate_figure(vt_eda, top = text_grob("Top 5 Female Athletes by Vault Scores in 2022-2023", size = 18))
vt_eda
```
**Figure 15: **  No matter the scenario, U.S. athlete Simone Biles ranked first while Brazilian athlete Rebeca Andrade ranked second. Third place was a toss up between U.S. athlete Jade Carey for the average and best scores and German athlete Sarah Voss for the worst scores. 

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
women_bb <- women%>%
  filter(stringr::str_like(Apparatus,'BB%'))

women_bb_summary <- women_bb %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

bb_avg <- women_bb_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

bb_best <- women_bb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

bb_worst <- women_bb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

bb_eda <- ggpubr::ggarrange(bb_worst, bb_avg, bb_best, ncol = 3, common.legend = T)
bb_eda <- ggpubr::annotate_figure(bb_eda, top = text_grob("Top 5 Female Athletes by Balance Beam Scores in 2022-2023", size = 18))
bb_eda

```

**Figure 16: ** Chinese athletes rank on top when considering each athlete’s worst and average score for balance beam. However, U.S. athletes rank higher when considering the best scores.

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
women_fx <- women%>%
  filter(stringr::str_like(Apparatus,'FX%'))

women_fx_summary <- women_fx %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

fx_avg <- women_fx_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

fx_best <- women_fx_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

fx_worst <- women_fx_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

fx_eda <- ggpubr::ggarrange(fx_worst, fx_avg, fx_best, ncol = 3, common.legend = T)
fx_eda <- ggpubr::annotate_figure(fx_eda, top = text_grob("Top 5 Female Athletes by Floor Scores in 2022-2023", size = 18))
fx_eda


```

**Figure 17: ** U.S. athletes dominate for the worst, average, and best floor scores. Of these athletes, Simone Biles ranked first for all scenarios. Rebeca Andrade placed second for all scenarios as well. For the worst scores, French athlete Melanie De placed third, but for the average and best scores British athlete Jessica Gadirova  ranked third.

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
women_ub <- women%>%
  filter(stringr::str_like(Apparatus,'UB%'))

# best average scores
women_ub_summary <- women_ub %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 



ub_avg <- women_ub_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

ub_best <- women_ub_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

ub_worst <- women_ub_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

ub_eda <- ggpubr::ggarrange(ub_worst, ub_avg, ub_best, ncol = 3, common.legend = T)
ub_eda <- ggpubr::annotate_figure(ub_eda, top = text_grob("Top 5 Female Athletes by Uneven Bar Scores in 2022-2023", size = 18))
ub_eda
```
**Figure 18: ** It’s evident that Algerian gymnast Kaylia Nemour is the most dominant athlete on uneven bars given her worst, average, and best scores. The U.S. does not appear to be a super strong contender in this event compared to others, ranking 3rd and 4th in these scenarios. 

**Figures 19-24: Men’s Worst, Average, and Best Scores by Apparatus**

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
men_vt <- men%>%
  filter(stringr::str_like(Apparatus,'VT%') & Rank <= 5)

men_vt_summary <- men_vt %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 


vt_avg <- men_vt_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

vt_best <- men_vt_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

vt_worst <- men_vt_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

vt_eda <- ggpubr::ggarrange(vt_worst, vt_avg, vt_best, ncol = 3, common.legend = T)
vt_eda <- ggpubr::annotate_figure(vt_eda, top = text_grob("Top 5 Male Athletes by Vault Scores in 2022-2023", size = 18))
vt_eda
```

**Figure 19: ** Japanese athletes tend to rank first for vault given the best, average, and worst scores. U.S. athletes commonly rank second and there appears to be quite a few of athletes that could be top 3 contenders. 

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
men_ph <- men%>%
  filter(stringr::str_like(Apparatus,'PH%') & Rank <= 5)

men_ph_summary <- men_ph %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

ph_avg <- men_ph_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

ph_best <- men_ph_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

ph_worst <- men_ph_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 


ph_eda <- ggpubr::ggarrange(ph_worst, ph_avg, ph_best, ncol = 3, common.legend = T)
ph_eda <- ggpubr::annotate_figure(ph_eda, top = text_grob("Top 5 Male Athletes by Pommel Horse Scores in 2022-2023", size = 18))
ph_eda
```

**Figure 20: ** Japan ranks first for the worst and average scores, but Britain ranks first for the best scores. There are a few U.S. athletes that rank in the top 3 for at least one of the scenarios, namely Khoi Young and Stephen Nerdoscik.

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
men_hb <- men%>%
  filter(stringr::str_like(Apparatus,'HB%') & Rank <= 5)

men_hb_summary <- men_hb %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 


hb_avg <- men_hb_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

hb_best <- men_hb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

hb_worst <- men_hb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 


hb_eda <- ggpubr::ggarrange(hb_worst, ph_avg, ph_best, ncol = 3, common.legend = T)
hb_eda <- ggpubr::annotate_figure(hb_eda, top = text_grob("Top 5 Male Athletes by Horizontal Bar Scores in 2022-2023", size = 18))
hb_eda
```

**Figure 21: ** Interestingly, the placements for horizontal bars by county almost reflects the placements for pommel horse. Again, Japan places first for the worst and average scores while Britain ranks first for the best scores. U.S. athletes Khoi Young and Stephen Nerdoscik also place in the top 3 for some of the scenarios. 

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
men_sr <- men%>%
  filter(stringr::str_like(Apparatus,'PB%') & Rank <= 5)

men_sr_summary <- men_sr %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 


sr_avg <- men_sr_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

sr_best <- men_sr_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

sr_worst <- men_sr_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

sr_eda <- ggpubr::ggarrange(sr_worst, sr_avg, sr_best, ncol = 3, common.legend = T)
  sr_eda <- ggpubr::annotate_figure(sr_eda, top = text_grob("Top 5 Male Athletes by Still Ring Scores in 2022-2023", size = 18))
sr_eda
```

**Figure 22: ** Chinese athlete Jingyuan Zou ranks first for all still rings scenarios. The U.S. appears unlikely to rank for this event given that the only time the U.S. places in the top 3 is for the best scores. 



```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}
men_fx <- men%>%
  filter(stringr::str_like(Apparatus,'FX%') & Rank <= 5)

men_fx_summary <- men_fx %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

fx_avg <- men_fx_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

fx_best <- men_fx_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

fx_worst <- men_fx_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 


fx_eda <- ggpubr::ggarrange(fx_worst, fx_avg, fx_best, ncol = 3, common.legend = T)
fx_eda <- ggpubr::annotate_figure(fx_eda, top = text_grob("Top 5 Male Athletes by Floor Scores in 2022-2023", size = 18))
fx_eda
```

**Figure 23:  ** The result by best, average, and worst floor scores are varied. U.S. athlete Matt Cormier ranked first given the worst scores, second for the average score, and not at all for the best score.

```{r fig.height=8, fig.width=16, echo=FALSE, warning=FALSE, message=FALSE}

men_pb <- men%>%
  filter(stringr::str_like(Apparatus,'PB%') & Rank <= 5)

men_pb_summary <- men_pb %>%
  group_by(FullName, Country) %>%
  summarise(avg_score = mean(Score), min_score = min(Score), max_score = max(Score)) 

pb_avg <- men_pb_summary %>%
  ungroup() %>%
  arrange(desc(avg_score)) %>%
  slice(1:5) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, avg_score), x = avg_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Average Score",
       y = "Athlete", x = "Average Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

pb_best <- men_pb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(max_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, max_score), x = max_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Best Score",
       y = "Athlete", x = "Best Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y")

pb_worst <- men_pb_summary %>%
  ungroup() %>%
  #group_by(Country) %>%
  arrange(desc(min_score)) %>%
  slice(1:5) %>%
  #ungroup() %>%
  #arrange(desc(min_score)) %>%
  mutate(rank = ifelse(row_number() <= 5, row_number(), NA), rank = as.factor(rank)) %>%
  ggplot(aes(y= reorder(FullName, min_score), x = min_score, fill = rank)) +
  geom_col(stat = "identity") +
  labs(title = "Top Athletes by Worst Score",
       y = "Athlete", x = "Worst Score") +
  facet_wrap(~factor(Country, unique(Country)), ncol = 1, scales = "free_y") 

pb_eda <- ggpubr::ggarrange(pb_worst, pb_avg, pb_best, ncol = 3, common.legend = T)
pb_eda <- ggpubr::annotate_figure(pb_eda, top = text_grob("Top 5 Male Athletes by Parallel Bar Scores in 2022-2023", size = 18))
pb_eda
```

**Figure 24: ** Chinese athlete Jingyuan Zou ranked first for all of the parallel bar scenarios. The U.S. only ranked in the top three for best scores with Phillips Curran.


\newpage
## VI. Sources Cited
1. "Poll: Gymnastics Is America’s Most Highly Anticipated Olympic Sport". SGB Media. 2021. [https://sgbonline.com/poll-gymnastics-is-americans-most-highly-anticipated-olympic-sport/](https://sgbonline.com/poll-gymnastics-is-americans-most-highly-anticipated-olympic-sport/)
2. "How one adjustment helped USA Gymnastics become a power and led to Rio gold". Sports Illustrated. 2016. [https://www.si.com/olympics/2016/08/10/usa-womens-gymnastics-system-rio-olympics-martha-karolyi](https://www.si.com/olympics/2016/08/10/usa-womens-gymnastics-system-rio-olympics-martha-karolyi).
3. United States men's national artistic gymnastics team. Wikipedia. [https://en.wikipedia.org/wiki/United_States_men%27s_national_artistic_gymnastics_team](https://en.wikipedia.org/wiki/United_States_men%27s_national_artistic_gymnastics_team)
4. Paris 2024 - Artistic Gymnastics. [https://www.paris2024.org/en/sport/artistic-gymnastics/](https://www.paris2024.org/en/sport/artistic-gymnastics/)
5. "Minneapolis, Minnesota to host 2024 US Olympic Team Trials – Gymnastics, become Gymnastics City USA 2024". USA Gymnastics. 2023. [https://usagym.org/minneapolis-minnesota-to-host-2024-u-s-olympic-team-trials-gymnastics-become-gymnastics-city-usa-2024/](https://usagym.org/minneapolis-minnesota-to-host-2024-u-s-olympic-team-trials-gymnastics-become-gymnastics-city-usa-2024/)
6. "What to know about the US Olympic gymnastics trials". The Seattle Times. 2021. [https://www.seattletimes.com/sports/olympics/what-to-know-about-the-u-s-olympic-gymnastics-trials/](https://www.seattletimes.com/sports/olympics/what-to-know-about-the-u-s-olympic-gymnastics-trials/)
7. "Picking a strong US gymnastics team is easy. Whom to leave out is hard". The Washington Post. 2023. [https://www.washingtonpost.com/sports/olympics/2023/08/29/us-gymnastics-team-world-championships/](https://www.washingtonpost.com/sports/olympics/2023/08/29/us-gymnastics-team-world-championships/)
8. Vinué, G, Epifanio, I. Forecasting basketball players' performance using sparse functional data. Stat Anal Data Min: The ASA Data Sci Journal. 2019; 12: 534–547. https://doi.org/10.1002/sam.11436
9. Vinué, G, Epifanio, I. Forecasting basketball players' performance using sparse functional data. Stat Anal Data Min: The ASA Data Sci Journal. 2019; 12: 534–547. https://doi.org/10.1002/sam.11436
10. Osken, C.; Onay, C. Predicting the winning team in basketball: A novel approach. Heliyon 2022, 8, e12189. [https://www.sciencedirect.com/science/article/pii/S2405844022034776?via%3Dihub]
11. Atikovic, A., Kalinski, S. D., Cuk, I. Age trends in artistic gymnastic across world championships and the olympic games from 2003 to 2016. Science of Gymnastics Journal. 2017. [https://www.researchgate.net/publication/320335292_Age_trends_in_artistic_gymnastic_across_world_championships_and_the_olympic_games_from_2003_to_2016](https://www.researchgate.net/publication/320335292_Age_trends_in_artistic_gymnastic_across_world_championships_and_the_olympic_games_from_2003_to_2016)
12. Deng, H., Wickham, H. Density estimation in R. 2011. [https://vita.had.co.nz/papers/density-estimation.pdf](https://vita.had.co.nz/papers/density-estimation.pdf)
13. Wand, M., Moler, Cleve., Ripley, B. "Package KernSmooth". CRAN. 2023. [https://cran.r-project.org/web/packages/KernSmooth/KernSmooth.pdf](https://cran.r-project.org/web/packages/KernSmooth/KernSmooth.pdf)
14. "Gymnastics 101: Competition format". NBC Olympics. 2021. [https://www.nbcolympics.com/news/gymnastics-101-competition-format](https://www.nbcolympics.com/news/gymnastics-101-competition-format)
15. "Who Qualified to Paris 2024?". The Gymternet. 2023. [https://thegymter.net/2023/10/09/who-qualified-to-paris-2024/](https://thegymter.net/2023/10/09/who-qualified-to-paris-2024/)
16. "Worlds Team Preview #8 - The Netherlands". Reddit, r/Gymnastics. 2023. [https://www.reddit.com/r/Gymnastics/comments/16nqb9r/worlds_team_preview_8_the_netherlands/](https://www.reddit.com/r/Gymnastics/comments/16nqb9r/worlds_team_preview_8_the_netherlands/)
17. "Olympic gymnastics champion Suni Lee began pointing to 2024 long ago. It could be a difficult road". AP News. 2023. [https://apnews.com/article/sunisa-lee-paris-olympics-gymnastics-95c3857ec9338170792baca56ffe6c07](https://apnews.com/article/sunisa-lee-paris-olympics-gymnastics-95c3857ec9338170792baca56ffe6c07)
18. "ANOVA and the Bonferroni Correction". Towards Data Science. 2021. [https://towardsdatascience.com/anova-vs-bonferroni-correction-c8573936a64e?gi=ffb12a01219d](https://towardsdatascience.com/anova-vs-bonferroni-correction-c8573936a64e?gi=ffb12a01219d)
19. "Preview: Top Men’s Storylines for the 2023 World Championships". Inside Gymnastics Magazine. 2023. [https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/](https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/)
20. "Asher Hong is youngest U.S. men’s all-around gymnastics champion in 34 years". NBC Sports. 2023. [https://www.nbcsports.com/olympics/news/asher-hong-gymnastics-nationals](https://www.nbcsports.com/olympics/news/asher-hong-gymnastics-nationals)
21. "Is there room for a world gymnastics champion on the world championships team?". NBC Sports. 2022. [https://www.nbcsports.com/olympics/news/stephen-nedoroscik-gymnastics-pommel-horse-world-championships](https://www.nbcsports.com/olympics/news/stephen-nedoroscik-gymnastics-pommel-horse-world-championships)
22. "https://gymnastics-now.com/curran-phillips-and-the-pursuit-of-mastery/". Gymnastics Now. 2023. [https://gymnastics-now.com/curran-phillips-and-the-pursuit-of-mastery/](https://gymnastics-now.com/curran-phillips-and-the-pursuit-of-mastery/)
23. "Takeaways from gymnastics worlds: Looking ahead to the 2024 Olympics". ESPN. 2023. [https://www.espn.com/olympics/gymnastics/story/_/id/38603995/2023-gymnastics-worlds-results-2024-olympics-predictions](https://www.espn.com/olympics/gymnastics/story/_/id/38603995/2023-gymnastics-worlds-results-2024-olympics-predictions)
24. "Wu Ran". The Gymternet. 2023. [https://thegymter.net/wu-ran/](https://thegymter.net/wu-ran/)
25. "Zhou Yaqin". The Gymternet. 2023. [https://thegymter.net/zhou-yaqin/](https://thegymter.net/zhou-yaqin/)
26. "Miller wows on uneven bars, wins bet with Biles". NBC Sports. 2023. [https://www.nbcsports.com/watch/miller-wows-on-uneven-bars-wins-bet-with-biles](https://www.nbcsports.com/watch/miller-wows-on-uneven-bars-wins-bet-with-biles)
27. "USA's Jones narrowly misses gold in uneven bars". NBC Sports. 2022. [https://www.nbcsports.com/watch/usas-jones-narrowly-misses-gold-in-uneven-bars](https://www.nbcsports.com/watch/usas-jones-narrowly-misses-gold-in-uneven-bars)
28. "Brody Malone eyes spring 2024 return to gymnastics from leg surgeries". NBC Sports. 2023. [https://www.nbcsports.com/olympics/news/brody-malone-gymnastics-injury-comeback](https://www.nbcsports.com/olympics/news/brody-malone-gymnastics-injury-comeback)
29. "Preview: Top Men’s Storylines for the 2023 World Championships". Inside Gymnastics Magazine. 2023. [https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/](https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/)
30. "The U.S. men’s gymnastics program is running in place. The answer is easy. Getting there is not". AP News. 2023. [https://apnews.com/article/gymnastics-paris-olympics-1a7e791d35b7636e8d96800151d8fac8](https://apnews.com/article/gymnastics-paris-olympics-1a7e791d35b7636e8d96800151d8fac8)
31. "Takeaways from gymnastics worlds: Looking ahead to the 2024 Olympics". ESPN. 2023. [https://www.espn.com/olympics/gymnastics/story/_/id/38603995/2023-gymnastics-worlds-results-2024-olympics-predictions](https://www.espn.com/olympics/gymnastics/story/_/id/38603995/2023-gymnastics-worlds-results-2024-olympics-predictions)
32. "Hong Wins Title, Nine Named To National Team". Stanford Medicine. 2023. [https://gostanford.com/news/2023/8/26/mens-gymnastics-hong-wins-title-five-named-to-national-team.aspx](https://gostanford.com/news/2023/8/26/mens-gymnastics-hong-wins-title-five-named-to-national-team.aspx)
33. "Yul Moldauer". Wikipedia. [https://en.wikipedia.org/wiki/Yul_Moldauer](https://en.wikipedia.org/wiki/Yul_Moldauer)
34. "Donnell Whittenburg, still chasing an Olympic spot, in hunt at nationals". The Washington Post. 2022. [https://www.washingtonpost.com/sports/olympics/2022/08/18/us-gymnastics-mens-championships/](https://www.washingtonpost.com/sports/olympics/2022/08/18/us-gymnastics-mens-championships/)
35. "Asher Hong is youngest U.S. men’s all-around gymnastics champion in 34 years". NBC Sports. 2023. [https://www.nbcsports.com/olympics/news/asher-hong-gymnastics-nationals](https://www.nbcsports.com/olympics/news/asher-hong-gymnastics-nationals)
36. "Preview: Top Men’s Storylines for the 2023 World Championships". Inside Gymnastics Magazine. 2023. [https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/](https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/)
37. "Yul Moldauer". Wikipedia. [https://en.wikipedia.org/wiki/Yul_Moldauer](https://en.wikipedia.org/wiki/Yul_Moldauer)
38. "Donnell Whittenburg". Wikipedia. [https://en.wikipedia.org/wiki/Donnell_Whittenburg](https://en.wikipedia.org/wiki/Donnell_Whittenburg)
39. "Yul Moldauer". Wikipedia. [https://en.wikipedia.org/wiki/Yul_Moldauer](https://en.wikipedia.org/wiki/Yul_Moldauer)
40. "Preview: Top Men’s Storylines for the 2023 World Championships". Inside Gymnastics Magazine. 2023. [https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/](https://www.insidegymnastics.com/news-features/top-mens-storylines-for-the-2023-world-championships/)
41. Buckner, S., Bacon, N., Bishop, P. "Recovery in Level 7-10 Women's USA Artistic Gymnastics". National Library of Medicine. 2017. [https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5609667/](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5609667/)
42. "Jordan Chiles struggles through rough second night of gymnastics Nationals". Youtube, NBC Sports. 2023. [https://www.youtube.com/watch?v=Fl4-nM-iPp4](https://www.youtube.com/watch?v=Fl4-nM-iPp4)
